<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.11/semantic.css" />
		
		<style type="text/css">
			body > .ui.container {
				margin-top: 3em;
			}
			.greenicon {
			   color: #339933; 
			}
			.greenstatus {
			    color: #009933;
			}
			.redstatus {
			    color: #cc3300;
			}
		</style>
		<title>Wissen</title>
	</head>
	<body>
		<th:block th:include="${menuSource} :: ${menuFragment}"> </th:block>
		
		<th:block th:include="${contentSource} :: ${contentFragment}"></th:block>
		
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.11/semantic.min.js"></script>
		
		<script>
			$('.ui.dropdown').dropdown();
			$.ajax({
    	          type: 'GET',
    	          url: "/api/plants/search/findTop1ByOrderByLastWaterDesc",
    	          contentType: "application/json; charset=utf-8",
    	          success: function(resultData) {
    	              var x = document.getElementById("latest");
    	              if(x != null){
    	                  if(resultData._embedded.plants.length == 1){
        	                  var lDate = new Date(resultData._embedded.plants[0].lastWater);
        	                  var cDate = new Date();
        	                  var diff = (cDate.getTime()-lDate.getTime())/1000/60/60;

        	                  $("#latest").text(parseFloat(diff).toFixed(2) + " hours ago");
        	                  if(diff > 48){
        	                      $("#latest").addClass("redstatus");
        	                  } else {
        	                      $("#latest").addClass("greenstatus");
        	                  }
    	                  } else {
    	                      $("#latest").text("no data available");
    	                      $("#latest").addClass("redstatus");
    	                  }

    	              }
    	          }   
    	      });
		</script>
	</body>
</html>